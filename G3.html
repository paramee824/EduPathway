<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Welding Master VR - ‡πÄ‡∏Å‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏∏‡∏î‡πÄ‡∏ß‡∏≠‡∏£‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Kanit:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            overflow-x: hidden;
        }
        
        .orbitron {
            font-family: 'Orbitron', monospace;
        }
        
        .spark-effect {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffeb3b;
            border-radius: 50%;
            animation: spark 0.5s ease-out forwards;
        }
        
        @keyframes spark {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0) translate(var(--dx), var(--dy));
            }
        }
        
        .welding-arc {
            background: linear-gradient(45deg, #00bcd4, #2196f3, #9c27b0);
            box-shadow: 0 0 20px #00bcd4, 0 0 40px #2196f3;
            animation: arc-flicker 0.1s infinite alternate;
        }
        
        @keyframes arc-flicker {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        .heat-gauge {
            background: linear-gradient(90deg, #4caf50 0%, #ffeb3b 50%, #f44336 100%);
            transition: all 0.3s ease;
        }
        
        .metal-surface {
            background: linear-gradient(45deg, #37474f, #546e7a, #607d8b);
            border: 2px solid #263238;
            position: relative;
            overflow: hidden;
        }
        
        .weld-line {
            position: absolute;
            height: 4px;
            background: linear-gradient(90deg, #ff5722, #ff9800, #ffc107);
            box-shadow: 0 0 10px #ff5722;
            border-radius: 2px;
            transition: all 0.2s ease;
        }
        
        .structure-3d {
            perspective: 1000px;
            transform-style: preserve-3d;
        }
        
        .beam {
            background: linear-gradient(45deg, #455a64, #607d8b);
            border: 2px solid #37474f;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.3);
        }
        
        .emergency-alert {
            animation: emergency-blink 0.5s infinite alternate;
        }
        
        @keyframes emergency-blink {
            0% { background-color: #f44336; }
            100% { background-color: #d32f2f; }
        }
        
        .pressure-leak {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255,87,34,0.8) 0%, transparent 70%);
            border-radius: 50%;
            animation: leak-pulse 0.3s infinite;
        }
        
        @keyframes leak-pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        .skill-radar {
            position: relative;
            width: 200px;
            height: 200px;
            border: 2px solid #00bcd4;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0,188,212,0.1) 0%, transparent 70%);
        }
        
        .floating-ui {
            backdrop-filter: blur(10px);
            background: rgba(15, 15, 35, 0.9);
            border: 1px solid rgba(0, 188, 212, 0.3);
        }
        
        .neon-text {
            text-shadow: 0 0 10px #00bcd4, 0 0 20px #00bcd4, 0 0 30px #00bcd4;
        }
        
        .game-canvas {
            border: 2px solid #00bcd4;
            box-shadow: 0 0 30px rgba(0, 188, 212, 0.5);
            background: #1a1a2e;
        }
        
        .electrode-cursor {
            cursor: crosshair;
        }
        
        .welding-sound-wave {
            position: absolute;
            border: 2px solid rgba(0, 188, 212, 0.3);
            border-radius: 50%;
            animation: sound-wave 1s infinite;
        }
        
        @keyframes sound-wave {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="min-h-screen text-white">
    <!-- Main Menu -->
    <div id="mainMenu" class="min-h-screen flex items-center justify-center relative">
        <div class="absolute inset-0 bg-gradient-to-br from-blue-900/20 to-purple-900/20"></div>
        
        <!-- Animated Background Elements -->
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute top-20 left-20 w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></div>
            <div class="absolute top-40 right-32 w-1 h-1 bg-yellow-400 rounded-full animate-ping"></div>
            <div class="absolute bottom-32 left-1/4 w-3 h-3 bg-orange-400 rounded-full animate-bounce"></div>
        </div>
        
        <div class="text-center z-10 max-w-4xl mx-auto px-6">
            <h1 class="text-6xl font-black orbitron neon-text mb-4">
                üéÆ WELDING MASTER VR
            </h1>
            <p class="text-2xl text-cyan-300 mb-8">‡πÄ‡∏Å‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏∏‡∏î‡πÄ‡∏ß‡∏≠‡∏£‡πå - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÅ‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á</p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="floating-ui p-6 rounded-lg">
                    <div class="text-4xl mb-4">üî•</div>
                    <h3 class="text-xl font-bold text-orange-400 mb-2">Precision Sparks</h3>
                    <p class="text-sm text-gray-300">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏£‡∏á‡∏™‡∏π‡∏á<br>‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</p>
                </div>
                
                <div class="floating-ui p-6 rounded-lg">
                    <div class="text-4xl mb-4">üèóÔ∏è</div>
                    <h3 class="text-xl font-bold text-blue-400 mb-2">3D Welding Arena</h3>
                    <p class="text-sm text-gray-300">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á 3 ‡∏°‡∏¥‡∏ï‡∏¥<br>‡∏õ‡∏µ‡∏ô‡∏õ‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤</p>
                </div>
                
                <div class="floating-ui p-6 rounded-lg">
                    <div class="text-4xl mb-4">üö®</div>
                    <h3 class="text-xl font-bold text-red-400 mb-2">Rescue Welding</h3>
                    <p class="text-sm text-gray-300">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏π‡πâ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï<br>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÅ‡∏ï‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î</p>
                </div>
            </div>
            
            <div class="space-y-4">
                <button onclick="showLevelSelect()" class="bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 px-12 py-4 rounded-lg text-xl font-bold orbitron transform hover:scale-105 transition-all duration-300 shadow-lg">
                    üöÄ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô
                </button>
                
                <div class="flex justify-center space-x-4">
                    <button onclick="showRules()" class="bg-gray-700 hover:bg-gray-600 px-6 py-2 rounded-lg transition-colors">
                        üìã ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô
                    </button>
                    <button onclick="showTips()" class="bg-gray-700 hover:bg-gray-600 px-6 py-2 rounded-lg transition-colors">
                        üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rules Modal -->
    <div id="rulesModal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden">
        <div class="floating-ui max-w-2xl mx-4 p-8 rounded-lg">
            <h2 class="text-3xl font-bold orbitron text-cyan-400 mb-6">üìã ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
            
            <div class="space-y-4 text-sm">
                <div class="border-l-4 border-orange-400 pl-4">
                    <h3 class="font-bold text-orange-400">üî• ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1: Precision Sparks</h3>
                    <p>‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏•‡∏≤‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å</p>
                    <p>‚Ä¢ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Heat Gauge ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡πÅ‡∏î‡∏á</p>
                    <p>‚Ä¢ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÑ‡∏õ = ‡∏£‡∏≠‡∏¢‡πÅ‡∏ï‡∏Å / ‡∏ä‡πâ‡∏≤‡πÑ‡∏õ = ‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏•‡∏∞‡∏•‡∏≤‡∏¢</p>
                </div>
                
                <div class="border-l-4 border-blue-400 pl-4">
                    <h3 class="font-bold text-blue-400">üèóÔ∏è ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2: 3D Welding Arena</h3>
                    <p>‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á 3D</p>
                    <p>‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</p>
                    <p>‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÑ‡∏ü‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ</p>
                </div>
                
                <div class="border-l-4 border-red-400 pl-4">
                    <h3 class="font-bold text-red-400">üö® ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3: Rescue Welding</h3>
                    <p>‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Electrode, Shield, Gas)</p>
                    <p>‚Ä¢ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î</p>
                    <p>‚Ä¢ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î</p>
                </div>
            </div>
            
            <button onclick="closeRules()" class="mt-6 bg-cyan-500 hover:bg-cyan-600 px-6 py-2 rounded-lg transition-colors">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß
            </button>
        </div>
    </div>

    <!-- Tips Modal -->
    <div id="tipsModal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden">
        <div class="floating-ui max-w-2xl mx-4 p-8 rounded-lg">
            <h2 class="text-3xl font-bold orbitron text-yellow-400 mb-6">üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</h2>
            
            <div class="space-y-4 text-sm">
                <div class="bg-yellow-900/30 p-4 rounded-lg">
                    <h3 class="font-bold text-yellow-400 mb-2">üéØ ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°</h3>
                    <p>‚Ä¢ ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠</p>
                    <p>‚Ä¢ ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï Heat Gauge ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏™‡∏°‡∏≠</p>
                    <p>‚Ä¢ ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ</p>
                </div>
                
                <div class="bg-blue-900/30 p-4 rounded-lg">
                    <h3 class="font-bold text-blue-400 mb-2">‚ö° ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</h3>
                    <p>‚Ä¢ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ä‡πâ‡∏≤‡πÜ ‡πÉ‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                    <p>‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡πÅ‡∏•‡πâ‡∏ß</p>
                    <p>‚Ä¢ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏à‡∏∏‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏°‡∏∏‡∏°‡πÇ‡∏Ñ‡πâ‡∏á</p>
                </div>
                
                <div class="bg-red-900/30 p-4 rounded-lg">
                    <h3 class="font-bold text-red-400 mb-2">üö® ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</h3>
                    <p>‚Ä¢ ‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°</p>
                    <p>‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô</p>
                    <p>‚Ä¢ ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                </div>
            </div>
            
            <button onclick="closeTips()" class="mt-6 bg-yellow-500 hover:bg-yellow-600 px-6 py-2 rounded-lg transition-colors text-black font-bold">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß
            </button>
        </div>
    </div>

    <!-- Level Selection Modal -->
    <div id="levelSelectModal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden">
        <div class="floating-ui max-w-4xl mx-4 p-8 rounded-lg">
            <h2 class="text-3xl font-bold orbitron text-cyan-400 mb-6 text-center">üéÆ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
            
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="bg-gradient-to-br from-orange-900/50 to-orange-700/50 p-6 rounded-lg cursor-pointer hover:scale-105 transition-transform" onclick="startLevel(1)">
                    <div class="text-4xl mb-4 text-center">üî•</div>
                    <h3 class="text-xl font-bold text-orange-400 mb-2 text-center">‡∏î‡πà‡∏≤‡∏ô 1: Precision Sparks</h3>
                    <p class="text-sm text-gray-300 mb-4">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏£‡∏á‡∏™‡∏π‡∏á<br>‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</p>
                    <div class="text-xs text-yellow-300 bg-yellow-900/30 p-2 rounded">
                        üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≤‡∏Å‡∏ä‡πâ‡∏≤‡πÜ ‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-blue-900/50 to-blue-700/50 p-6 rounded-lg cursor-pointer hover:scale-105 transition-transform" onclick="startLevel(2)">
                    <div class="text-4xl mb-4 text-center">üèóÔ∏è</div>
                    <h3 class="text-xl font-bold text-blue-400 mb-2 text-center">‡∏î‡πà‡∏≤‡∏ô 2: 3D Welding Arena</h3>
                    <p class="text-sm text-gray-300 mb-4">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á 3 ‡∏°‡∏¥‡∏ï‡∏¥<br>‡∏õ‡∏µ‡∏ô‡∏õ‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤</p>
                    <div class="text-xs text-yellow-300 bg-yellow-900/30 p-2 rounded">
                        üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-red-900/50 to-red-700/50 p-6 rounded-lg cursor-pointer hover:scale-105 transition-transform" onclick="startLevel(3)">
                    <div class="text-4xl mb-4 text-center">üö®</div>
                    <h3 class="text-xl font-bold text-red-400 mb-2 text-center">‡∏î‡πà‡∏≤‡∏ô 3: Rescue Welding</h3>
                    <p class="text-sm text-gray-300 mb-4">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏π‡πâ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï<br>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÅ‡∏ï‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î</p>
                    <div class="text-xs text-yellow-300 bg-yellow-900/30 p-2 rounded">
                        üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button onclick="closeLevelSelect()" class="bg-gray-600 hover:bg-gray-500 px-6 py-2 rounded-lg transition-colors">
                    ‚ùå ‡∏õ‡∏¥‡∏î
                </button>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="hidden min-h-screen">
        <!-- Game Header -->
        <div class="floating-ui p-4 m-4 rounded-lg">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <h2 id="levelTitle" class="text-2xl font-bold orbitron text-cyan-400"></h2>
                    <div id="levelProgress" class="text-lg text-gray-300"></div>
                </div>
                
                <div class="flex items-center space-x-6">
                    <!-- Heat Gauge -->
                    <div id="heatGaugeContainer" class="hidden">
                        <label class="text-sm text-gray-300">üå°Ô∏è Heat:</label>
                        <div class="w-32 h-4 bg-gray-700 rounded-full overflow-hidden">
                            <div id="heatGauge" class="h-full heat-gauge transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden">
                        <label class="text-sm text-gray-300">‚è±Ô∏è Time:</label>
                        <span id="timer" class="text-xl font-bold orbitron text-yellow-400">60</span>
                    </div>
                    
                    <!-- Pressure Gauge -->
                    <div id="pressureContainer" class="hidden">
                        <label class="text-sm text-gray-300">üí• Pressure:</label>
                        <div class="w-32 h-4 bg-gray-700 rounded-full overflow-hidden">
                            <div id="pressureGauge" class="h-full bg-gradient-to-r from-green-500 to-red-500 transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <button onclick="pauseGame()" class="bg-gray-600 hover:bg-gray-500 px-4 py-2 rounded-lg transition-colors">
                        ‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
                    </button>
                    <button onclick="restartLevel()" class="bg-orange-600 hover:bg-orange-500 px-4 py-2 rounded-lg transition-colors">
                        üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
                    </button>
                    <button onclick="backToMenu()" class="bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg transition-colors">
                        üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                </div>
            </div>
        </div>

        <!-- Game Canvas Area -->
        <div class="flex justify-center p-4">
            <div id="gameCanvas" class="game-canvas rounded-lg relative" style="width: 800px; height: 600px;">
                <!-- Level 1: Precision Sparks -->
                <div id="level1Canvas" class="hidden w-full h-full relative electrode-cursor">
                    <div class="metal-surface w-full h-full flex items-center justify-center">
                        <svg id="weldingPath" width="600" height="400" class="absolute">
                            <path id="targetPath" d="M 50 200 L 550 200" stroke="#607d8b" stroke-width="6" fill="none" stroke-dasharray="15,10" opacity="0.7"/>
                            <path id="playerPath" d="" stroke="#ff5722" stroke-width="4" fill="none" class="welding-arc"/>
                        </svg>
                        <div id="electrode" class="absolute w-6 h-6 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full hidden shadow-lg border-2 border-yellow-300"></div>
                        
                        <!-- Start and End markers -->
                        <div class="absolute left-12 top-1/2 transform -translate-y-1/2 text-green-400 font-bold text-lg animate-pulse">START</div>
                        <div class="absolute right-12 top-1/2 transform -translate-y-1/2 text-red-400 font-bold text-lg animate-pulse">FINISH</div>
                    </div>
                </div>

                <!-- Level 2: 3D Welding Arena -->
                <div id="level2Canvas" class="hidden w-full h-full relative structure-3d">
                    <div class="absolute inset-0 bg-gradient-to-b from-gray-800 to-gray-900">
                        <!-- 3D Structure -->
                        <div class="absolute top-20 left-20 beam w-16 h-64 transform rotate-12"></div>
                        <div class="absolute top-40 right-32 beam w-64 h-16 transform -rotate-6"></div>
                        <div class="absolute bottom-32 left-1/3 beam w-48 h-12 transform rotate-3"></div>
                        
                        <!-- Welding Points -->
                        <div class="weld-point absolute top-32 left-28 w-6 h-6 bg-red-500 rounded-full cursor-pointer animate-pulse" onclick="weldPoint(this)"></div>
                        <div class="weld-point absolute top-48 right-40 w-6 h-6 bg-red-500 rounded-full cursor-pointer animate-pulse" onclick="weldPoint(this)"></div>
                        <div class="weld-point absolute bottom-40 left-1/2 w-6 h-6 bg-red-500 rounded-full cursor-pointer animate-pulse" onclick="weldPoint(this)"></div>
                        
                        <!-- Player Position -->
                        <div id="player3D" class="absolute bottom-10 left-1/2 w-8 h-8 bg-cyan-400 rounded-full transform -translate-x-1/2"></div>
                    </div>
                </div>

                <!-- Level 3: Rescue Welding -->
                <div id="level3Canvas" class="hidden w-full h-full relative">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-900/50 to-orange-900/50">
                        <!-- Emergency Background -->
                        <div class="emergency-alert absolute inset-0 opacity-20"></div>
                        
                        <!-- Pipe System -->
                        <div class="absolute top-1/3 left-20 w-64 h-16 bg-gray-600 rounded-lg border-4 border-gray-500">
                            <!-- Pressure Leaks -->
                            <div class="pressure-leak absolute top-2 left-32"></div>
                            <div class="pressure-leak absolute bottom-2 right-48"></div>
                            <div class="pressure-leak absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></div>
                        </div>
                        
                        <!-- Equipment Selection -->
                        <div class="absolute bottom-20 left-20 space-x-4">
                            <button onclick="selectEquipment('electrode')" class="equipment-btn bg-yellow-600 hover:bg-yellow-500 px-4 py-2 rounded-lg">
                                ‚ö° Electrode
                            </button>
                            <button onclick="selectEquipment('shield')" class="equipment-btn bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded-lg">
                                üõ°Ô∏è Shield
                            </button>
                            <button onclick="selectEquipment('gas')" class="equipment-btn bg-green-600 hover:bg-green-500 px-4 py-2 rounded-lg">
                                üí® Gas
                            </button>
                        </div>
                        
                        <!-- Leak Points -->
                        <div class="leak-point absolute top-40 left-52 w-8 h-8 bg-red-600 rounded-full cursor-pointer animate-ping" onclick="repairLeak(this)"></div>
                        <div class="leak-point absolute top-56 left-84 w-8 h-8 bg-red-600 rounded-full cursor-pointer animate-ping" onclick="repairLeak(this)"></div>
                        <div class="leak-point absolute top-48 left-68 w-8 h-8 bg-red-600 rounded-full cursor-pointer animate-ping" onclick="repairLeak(this)"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Instructions -->
        <div class="floating-ui p-4 m-4 rounded-lg">
            <p id="gameInstructions" class="text-center text-lg mb-2"></p>
            <div id="levelHint" class="text-center text-sm text-yellow-300 bg-yellow-900/20 p-2 rounded hidden">
                üí° <span id="hintText"></span>
            </div>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="resultsScreen" class="hidden min-h-screen flex items-center justify-center">
        <div class="floating-ui max-w-4xl mx-4 p-8 rounded-lg text-center">
            <h2 class="text-4xl font-bold orbitron neon-text mb-8">üèÜ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h2>
            
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="bg-gradient-to-br from-orange-900/50 to-orange-700/50 p-6 rounded-lg">
                    <div class="text-3xl mb-2">üéØ</div>
                    <h3 class="text-xl font-bold text-orange-400 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</h3>
                    <div class="text-3xl font-bold orbitron" id="accuracyScore">0%</div>
                    <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                        <div id="accuracyBar" class="bg-orange-400 h-2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-blue-900/50 to-blue-700/50 p-6 rounded-lg">
                    <div class="text-3xl mb-2">‚ö°</div>
                    <h3 class="text-xl font-bold text-blue-400 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</h3>
                    <div class="text-3xl font-bold orbitron" id="speedScore">0%</div>
                    <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                        <div id="speedBar" class="bg-blue-400 h-2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-green-900/50 to-green-700/50 p-6 rounded-lg">
                    <div class="text-3xl mb-2">üõ°Ô∏è</div>
                    <h3 class="text-xl font-bold text-green-400 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h3>
                    <div class="text-3xl font-bold orbitron" id="safetyScore">0%</div>
                    <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                        <div id="safetyBar" class="bg-green-400 h-2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                <h3 class="text-2xl font-bold mb-4">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</h3>
                <div class="text-6xl font-bold orbitron neon-text mb-4" id="totalScore">0</div>
                <div id="skillLevel" class="text-xl font-bold mb-4"></div>
                <div id="recommendation" class="text-lg text-gray-300 max-w-2xl mx-auto"></div>
            </div>
            
            <div class="space-x-4">
                <button onclick="restartGame()" class="bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 px-8 py-3 rounded-lg text-lg font-bold orbitron transition-all duration-300">
                    üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                </button>
                <button onclick="backToMenu()" class="bg-gray-600 hover:bg-gray-500 px-8 py-3 rounded-lg text-lg font-bold transition-colors">
                    üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentLevel: 1,
            isPlaying: false,
            isPaused: false,
            scores: {
                accuracy: 0,
                speed: 0,
                safety: 0
            },
            level1: {
                heat: 0,
                weldProgress: 0,
                isWelding: false,
                playerPath: '',
                startTime: null
            },
            level2: {
                weldedPoints: 0,
                totalPoints: 3,
                timeLeft: 60,
                playerPosition: { x: 50, y: 90 }
            },
            level3: {
                selectedEquipment: null,
                repairedLeaks: 0,
                totalLeaks: 3,
                pressure: 0,
                timeLeft: 45
            }
        };

        // Audio Context for Sound Effects
        let audioContext;
        let weldingSound = false;

        // Initialize Audio
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Play Welding Sound Effect
        function playWeldingSound() {
            if (!audioContext || weldingSound) return;
            
            weldingSound = true;
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
            
            setTimeout(() => { weldingSound = false; }, 100);
        }

        // Create Spark Effects
        function createSparks(x, y, count = 5) {
            for (let i = 0; i < count; i++) {
                const spark = document.createElement('div');
                spark.className = 'spark-effect';
                spark.style.left = x + 'px';
                spark.style.top = y + 'px';
                spark.style.setProperty('--dx', (Math.random() - 0.5) * 100 + 'px');
                spark.style.setProperty('--dy', (Math.random() - 0.5) * 100 + 'px');
                
                document.getElementById('gameCanvas').appendChild(spark);
                
                setTimeout(() => {
                    if (spark.parentNode) {
                        spark.parentNode.removeChild(spark);
                    }
                }, 500);
            }
        }

        // Show/Hide Modals
        function showRules() {
            document.getElementById('rulesModal').classList.remove('hidden');
        }

        function closeRules() {
            document.getElementById('rulesModal').classList.add('hidden');
        }

        function showTips() {
            document.getElementById('tipsModal').classList.remove('hidden');
        }

        function closeTips() {
            document.getElementById('tipsModal').classList.add('hidden');
        }

        function showLevelSelect() {
            document.getElementById('levelSelectModal').classList.remove('hidden');
        }

        function closeLevelSelect() {
            document.getElementById('levelSelectModal').classList.add('hidden');
        }

        // Start Game
        function startGame() {
            initAudio();
            gameState.currentLevel = 1;
            gameState.isPlaying = true;
            gameState.scores = { accuracy: 0, speed: 0, safety: 0 };
            
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            startLevel1();
        }

        // Start Specific Level
        function startLevel(levelNumber) {
            closeLevelSelect();
            initAudio();
            gameState.currentLevel = levelNumber;
            gameState.isPlaying = true;
            gameState.scores = { accuracy: 0, speed: 0, safety: 0 };
            
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            if (levelNumber === 1) {
                startLevel1();
            } else if (levelNumber === 2) {
                startLevel2();
            } else if (levelNumber === 3) {
                startLevel3();
            }
        }

        // Level 1: Precision Sparks
        function startLevel1() {
            gameState.currentLevel = 1;
            gameState.level1 = {
                heat: 0,
                weldProgress: 0,
                isWelding: false,
                playerPath: '',
                startTime: Date.now()
            };
            
            document.getElementById('levelTitle').textContent = 'üî• Level 1: Precision Sparks';
            document.getElementById('levelProgress').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏Ç‡∏ß‡∏≤';
            document.getElementById('gameInstructions').textContent = '‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° - ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡πÅ‡∏î‡∏á!';
            
            // Show hint
            document.getElementById('levelHint').classList.remove('hidden');
            document.getElementById('hintText').textContent = '‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≤‡∏Å‡∏ä‡πâ‡∏≤‡πÜ ‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞ ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ';
            
            // Show relevant UI
            document.getElementById('heatGaugeContainer').classList.remove('hidden');
            document.getElementById('timerContainer').classList.add('hidden');
            document.getElementById('pressureContainer').classList.add('hidden');
            
            // Show level canvas
            document.getElementById('level1Canvas').classList.remove('hidden');
            document.getElementById('level2Canvas').classList.add('hidden');
            document.getElementById('level3Canvas').classList.add('hidden');
            
            setupLevel1Events();
        }

        function setupLevel1Events() {
            const canvas = document.getElementById('level1Canvas');
            let isMouseDown = false;
            
            // Mouse events
            canvas.addEventListener('mousedown', function(e) {
                e.preventDefault();
                isMouseDown = true;
                startWelding(e);
            });
            
            canvas.addEventListener('mousemove', function(e) {
                e.preventDefault();
                if (isMouseDown) {
                    updateWelding(e);
                } else {
                    // Just update electrode position when not welding
                    const rect = e.currentTarget.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const electrode = document.getElementById('electrode');
                    electrode.style.display = 'block';
                    electrode.style.left = (x - 8) + 'px';
                    electrode.style.top = (y - 8) + 'px';
                }
            });
            
            canvas.addEventListener('mouseup', function(e) {
                e.preventDefault();
                isMouseDown = false;
                stopWelding(e);
            });
            
            canvas.addEventListener('mouseleave', function(e) {
                e.preventDefault();
                isMouseDown = false;
                stopWelding(e);
            });
            
            // Touch events for mobile
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                isMouseDown = true;
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousedown', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                startWelding(mouseEvent);
            });
            
            canvas.addEventListener('touchmove', function(e) {
                e.preventDefault();
                if (isMouseDown) {
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousemove', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    updateWelding(mouseEvent);
                }
            });
            
            canvas.addEventListener('touchend', function(e) {
                e.preventDefault();
                isMouseDown = false;
                stopWelding();
            });
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 'mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            e.target.dispatchEvent(mouseEvent);
        }

        function startWelding(e) {
            if (!gameState.isPlaying || gameState.isPaused) return;
            
            e.preventDefault();
            gameState.level1.isWelding = true;
            const rect = e.currentTarget.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Start new path if not continuing
            if (!gameState.level1.playerPath || gameState.level1.playerPath === '') {
                gameState.level1.playerPath = `M ${x} ${y}`;
            }
            document.getElementById('playerPath').setAttribute('d', gameState.level1.playerPath);
            
            // Show electrode
            const electrode = document.getElementById('electrode');
            electrode.style.display = 'block';
            electrode.style.left = (x - 8) + 'px';
            electrode.style.top = (y - 8) + 'px';
            
            createSparks(x, y, 5);
            playWeldingSound();
        }

        function updateWelding(e) {
            if (!gameState.level1.isWelding || !gameState.isPlaying || gameState.isPaused) return;
            
            e.preventDefault();
            const rect = e.currentTarget.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Update electrode position
            const electrode = document.getElementById('electrode');
            electrode.style.display = 'block';
            electrode.style.left = (x - 8) + 'px';
            electrode.style.top = (y - 8) + 'px';
            
            // Update welding path - make sure we have a valid starting point
            if (!gameState.level1.playerPath || gameState.level1.playerPath === '') {
                gameState.level1.playerPath = `M ${x} ${y}`;
            } else {
                gameState.level1.playerPath += ` L ${x} ${y}`;
            }
            
            // Apply the path to the SVG
            const playerPathElement = document.getElementById('playerPath');
            playerPathElement.setAttribute('d', gameState.level1.playerPath);
            
            // Calculate welding progress based on horizontal movement (more generous)
            const progressX = Math.max(0, Math.min(100, (x - 50) / 500 * 100));
            gameState.level1.weldProgress = Math.max(gameState.level1.weldProgress, progressX);
            
            // Much slower heat increase for easier control
            gameState.level1.heat += 0.5;
            if (gameState.level1.heat > 100) gameState.level1.heat = 100;
            
            updateHeatGauge();
            createSparks(x, y, 2);
            
            // Update progress display
            document.getElementById('levelProgress').textContent = `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: ${Math.round(gameState.level1.weldProgress)}%`;
            
            // Check completion (much easier threshold)
            if (gameState.level1.weldProgress >= 75) {
                setTimeout(() => {
                    completeLevel1();
                }, 500);
            }
            
            // Play sound occasionally to avoid spam
            if (Math.random() < 0.3) {
                playWeldingSound();
            }
        }

        function stopWelding(e) {
            if (e) e.preventDefault();
            
            gameState.level1.isWelding = false;
            
            // Cool down heat gradually (much faster cooling)
            if (!gameState.level1.coolDownActive) {
                gameState.level1.coolDownActive = true;
                const coolDown = setInterval(() => {
                    if (gameState.level1.heat > 0 && !gameState.level1.isWelding) {
                        gameState.level1.heat -= 2.0;
                        if (gameState.level1.heat < 0) gameState.level1.heat = 0;
                        updateHeatGauge();
                    } else if (gameState.level1.heat <= 0) {
                        gameState.level1.coolDownActive = false;
                        clearInterval(coolDown);
                    }
                }, 30);
            }
        }

        function updateHeatGauge() {
            const heatGauge = document.getElementById('heatGauge');
            heatGauge.style.width = gameState.level1.heat + '%';
            
            if (gameState.level1.heat > 80) {
                heatGauge.style.background = 'linear-gradient(90deg, #f44336 0%, #d32f2f 100%)';
            } else if (gameState.level1.heat > 50) {
                heatGauge.style.background = 'linear-gradient(90deg, #ffeb3b 0%, #ff9800 100%)';
            } else {
                heatGauge.style.background = 'linear-gradient(90deg, #4caf50 0%, #8bc34a 100%)';
            }
        }

        function completeLevel1() {
            const endTime = Date.now();
            const timeSpent = (endTime - gameState.level1.startTime) / 1000;
            
            // Calculate scores
            const accuracyScore = Math.max(0, 100 - gameState.level1.heat);
            const speedScore = Math.max(0, 100 - (timeSpent - 10) * 2);
            const safetyScore = gameState.level1.heat < 80 ? 100 : 50;
            
            gameState.scores.accuracy += accuracyScore / 3;
            gameState.scores.speed += speedScore / 3;
            gameState.scores.safety += safetyScore / 3;
            
            setTimeout(() => {
                startLevel2();
            }, 1000);
        }

        // Level 2: 3D Welding Arena
        function startLevel2() {
            gameState.currentLevel = 2;
            gameState.level2 = {
                weldedPoints: 0,
                totalPoints: 3,
                timeLeft: 60,
                playerPosition: { x: 50, y: 90 }
            };
            
            document.getElementById('levelTitle').textContent = 'üèóÔ∏è Level 2: 3D Welding Arena';
            document.getElementById('levelProgress').textContent = `‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${gameState.level2.totalPoints - gameState.level2.weldedPoints}`;
            document.getElementById('gameInstructions').textContent = '‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° - ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏î!';
            
            // Show hint
            document.getElementById('levelHint').classList.remove('hidden');
            document.getElementById('hintText').textContent = '‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏î';
            
            // Show relevant UI
            document.getElementById('heatGaugeContainer').classList.add('hidden');
            document.getElementById('timerContainer').classList.remove('hidden');
            document.getElementById('pressureContainer').classList.add('hidden');
            
            // Show level canvas
            document.getElementById('level1Canvas').classList.add('hidden');
            document.getElementById('level2Canvas').classList.remove('hidden');
            document.getElementById('level3Canvas').classList.add('hidden');
            
            startLevel2Timer();
        }

        function startLevel2Timer() {
            const timer = setInterval(() => {
                if (!gameState.isPlaying || gameState.isPaused) return;
                
                gameState.level2.timeLeft--;
                document.getElementById('timer').textContent = gameState.level2.timeLeft;
                
                if (gameState.level2.timeLeft <= 0) {
                    clearInterval(timer);
                    completeLevel2();
                }
            }, 1000);
        }

        function weldPoint(element) {
            if (!gameState.isPlaying) return;
            
            element.style.background = '#4caf50';
            element.classList.remove('animate-pulse');
            element.onclick = null;
            
            gameState.level2.weldedPoints++;
            document.getElementById('levelProgress').textContent = `‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${gameState.level2.totalPoints - gameState.level2.weldedPoints}`;
            
            // Create welding effect
            const rect = element.getBoundingClientRect();
            const canvasRect = document.getElementById('level2Canvas').getBoundingClientRect();
            createSparks(rect.left - canvasRect.left + 12, rect.top - canvasRect.top + 12, 8);
            
            playWeldingSound();
            
            if (gameState.level2.weldedPoints >= gameState.level2.totalPoints) {
                setTimeout(() => {
                    completeLevel2();
                }, 500);
            }
        }

        function completeLevel2() {
            // Calculate scores
            const accuracyScore = (gameState.level2.weldedPoints / gameState.level2.totalPoints) * 100;
            const speedScore = Math.max(0, (gameState.level2.timeLeft / 60) * 100);
            const safetyScore = gameState.level2.weldedPoints === gameState.level2.totalPoints ? 100 : 70;
            
            gameState.scores.accuracy += accuracyScore / 3;
            gameState.scores.speed += speedScore / 3;
            gameState.scores.safety += safetyScore / 3;
            
            setTimeout(() => {
                startLevel3();
            }, 1000);
        }

        // Level 3: Rescue Welding
        function startLevel3() {
            gameState.currentLevel = 3;
            gameState.level3 = {
                selectedEquipment: null,
                repairedLeaks: 0,
                totalLeaks: 3,
                pressure: 0,
                timeLeft: 45
            };
            
            document.getElementById('levelTitle').textContent = 'üö® Level 3: Rescue Welding';
            document.getElementById('levelProgress').textContent = `‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${gameState.level3.totalLeaks - gameState.level3.repairedLeaks}`;
            document.getElementById('gameInstructions').textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß - ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î!';
            
            // Show hint
            document.getElementById('levelHint').classList.remove('hidden');
            document.getElementById('hintText').textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô (Electrode‚ÜíShield‚ÜíGas) ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö';
            
            // Show relevant UI
            document.getElementById('heatGaugeContainer').classList.add('hidden');
            document.getElementById('timerContainer').classList.remove('hidden');
            document.getElementById('pressureContainer').classList.remove('hidden');
            
            // Show level canvas
            document.getElementById('level1Canvas').classList.add('hidden');
            document.getElementById('level2Canvas').classList.add('hidden');
            document.getElementById('level3Canvas').classList.remove('hidden');
            
            startLevel3Timer();
            startPressureIncrease();
        }

        function startLevel3Timer() {
            const timer = setInterval(() => {
                if (!gameState.isPlaying || gameState.isPaused) return;
                
                gameState.level3.timeLeft--;
                document.getElementById('timer').textContent = gameState.level3.timeLeft;
                
                if (gameState.level3.timeLeft <= 0) {
                    clearInterval(timer);
                    completeLevel3();
                }
            }, 1000);
        }

        function startPressureIncrease() {
            const pressureTimer = setInterval(() => {
                if (!gameState.isPlaying || gameState.isPaused) return;
                
                gameState.level3.pressure += 2;
                if (gameState.level3.pressure > 100) gameState.level3.pressure = 100;
                
                document.getElementById('pressureGauge').style.width = gameState.level3.pressure + '%';
                
                if (gameState.level3.pressure >= 100) {
                    clearInterval(pressureTimer);
                    completeLevel3();
                }
            }, 500);
        }

        function selectEquipment(type) {
            gameState.level3.selectedEquipment = type;
            
            // Update button states
            document.querySelectorAll('.equipment-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-cyan-400');
            });
            
            event.target.classList.add('ring-4', 'ring-cyan-400');
        }

        function repairLeak(element) {
            if (!gameState.isPlaying || !gameState.level3.selectedEquipment) {
                alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡πà‡∏≠‡∏°!');
                return;
            }
            
            // Check if correct equipment is selected (simplified logic)
            const correctEquipment = ['electrode', 'shield', 'gas'][gameState.level3.repairedLeaks];
            const isCorrect = gameState.level3.selectedEquipment === correctEquipment;
            
            if (isCorrect) {
                element.style.background = '#4caf50';
                element.classList.remove('animate-ping');
                element.onclick = null;
                
                gameState.level3.repairedLeaks++;
                gameState.level3.pressure = Math.max(0, gameState.level3.pressure - 20);
                
                document.getElementById('levelProgress').textContent = `‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${gameState.level3.totalLeaks - gameState.level3.repairedLeaks}`;
                
                // Create repair effect
                const rect = element.getBoundingClientRect();
                const canvasRect = document.getElementById('level3Canvas').getBoundingClientRect();
                createSparks(rect.left - canvasRect.left + 16, rect.top - canvasRect.top + 16, 10);
                
                playWeldingSound();
                
                if (gameState.level3.repairedLeaks >= gameState.level3.totalLeaks) {
                    setTimeout(() => {
                        completeLevel3();
                    }, 500);
                }
            } else {
                gameState.level3.pressure += 10;
                alert('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô');
            }
        }

        function completeLevel3() {
            // Calculate final scores
            const accuracyScore = (gameState.level3.repairedLeaks / gameState.level3.totalLeaks) * 100;
            const speedScore = Math.max(0, (gameState.level3.timeLeft / 45) * 100);
            const safetyScore = Math.max(0, 100 - gameState.level3.pressure);
            
            gameState.scores.accuracy += accuracyScore / 3;
            gameState.scores.speed += speedScore / 3;
            gameState.scores.safety += safetyScore / 3;
            
            gameState.isPlaying = false;
            showResults();
        }

        // Show Results
        function showResults() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            
            // Animate score display
            setTimeout(() => {
                animateScore('accuracy', Math.round(gameState.scores.accuracy));
            }, 500);
            
            setTimeout(() => {
                animateScore('speed', Math.round(gameState.scores.speed));
            }, 1000);
            
            setTimeout(() => {
                animateScore('safety', Math.round(gameState.scores.safety));
            }, 1500);
            
            setTimeout(() => {
                const totalScore = Math.round((gameState.scores.accuracy + gameState.scores.speed + gameState.scores.safety) / 3);
                animateTotalScore(totalScore);
                showSkillAssessment(totalScore);
            }, 2000);
        }

        function animateScore(type, score) {
            const scoreElement = document.getElementById(type + 'Score');
            const barElement = document.getElementById(type + 'Bar');
            
            let currentScore = 0;
            const increment = score / 50;
            
            const animation = setInterval(() => {
                currentScore += increment;
                if (currentScore >= score) {
                    currentScore = score;
                    clearInterval(animation);
                }
                
                scoreElement.textContent = Math.round(currentScore) + '%';
                barElement.style.width = Math.round(currentScore) + '%';
            }, 20);
        }

        function animateTotalScore(totalScore) {
            const totalElement = document.getElementById('totalScore');
            let currentScore = 0;
            const increment = totalScore / 50;
            
            const animation = setInterval(() => {
                currentScore += increment;
                if (currentScore >= totalScore) {
                    currentScore = totalScore;
                    clearInterval(animation);
                }
                
                totalElement.textContent = Math.round(currentScore);
            }, 20);
        }

        function showSkillAssessment(totalScore) {
            const skillLevel = document.getElementById('skillLevel');
            const recommendation = document.getElementById('recommendation');
            
            if (totalScore >= 80) {
                skillLevel.innerHTML = 'üîß <span class="text-yellow-400">Master Welder</span>';
                skillLevel.className = 'text-xl font-bold mb-4 text-yellow-400';
                recommendation.textContent = '‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á';
            } else if (totalScore >= 65) {
                skillLevel.innerHTML = '‚ö° <span class="text-cyan-400">Quick Responder</span>';
                skillLevel.className = 'text-xl font-bold mb-4 text-cyan-400';
                recommendation.textContent = '‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏ô‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß';
            } else if (totalScore >= 50) {
                skillLevel.innerHTML = 'üéØ <span class="text-green-400">Organizer</span>';
                skillLevel.className = 'text-xl font-bold mb-4 text-green-400';
                recommendation.textContent = '‡∏î‡∏µ! ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏ô‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏á‡∏≤‡∏ô ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£';
            } else {
                skillLevel.innerHTML = 'üìö <span class="text-orange-400">‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤</span>';
                skillLevel.className = 'text-xl font-bold mb-4 text-orange-400';
                recommendation.textContent = '‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á ‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥';
            }
        }

        // Game Controls
        function pauseGame() {
            gameState.isPaused = !gameState.isPaused;
            const button = event.target;
            button.textContent = gameState.isPaused ? '‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠' : '‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß';
        }

        function restartGame() {
            // Reset all game state
            gameState = {
                currentLevel: 1,
                isPlaying: false,
                isPaused: false,
                scores: { accuracy: 0, speed: 0, safety: 0 },
                level1: { heat: 0, weldProgress: 0, isWelding: false, playerPath: '', startTime: null },
                level2: { weldedPoints: 0, totalPoints: 3, timeLeft: 60, playerPosition: { x: 50, y: 90 } },
                level3: { selectedEquipment: null, repairedLeaks: 0, totalLeaks: 3, pressure: 0, timeLeft: 45 }
            };
            
            // Reset UI elements
            document.getElementById('playerPath').setAttribute('d', '');
            document.querySelectorAll('.weld-point').forEach(point => {
                point.style.background = '#f44336';
                point.classList.add('animate-pulse');
                point.onclick = function() { weldPoint(this); };
            });
            document.querySelectorAll('.leak-point').forEach(leak => {
                leak.style.background = '#f44336';
                leak.classList.add('animate-ping');
                leak.onclick = function() { repairLeak(this); };
            });
            document.querySelectorAll('.equipment-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-cyan-400');
            });
            
            startGame();
        }

        function restartLevel() {
            if (gameState.currentLevel === 1) {
                startLevel1();
            } else if (gameState.currentLevel === 2) {
                startLevel2();
            } else if (gameState.currentLevel === 3) {
                startLevel3();
            }
        }

        function backToMenu() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            
            // Reset game state
            gameState = {
                currentLevel: 1,
                isPlaying: false,
                isPaused: false,
                scores: { accuracy: 0, speed: 0, safety: 0 },
                level1: { heat: 0, weldProgress: 0, isWelding: false, playerPath: '', startTime: null },
                level2: { weldedPoints: 0, totalPoints: 3, timeLeft: 60, playerPosition: { x: 50, y: 90 } },
                level3: { selectedEquipment: null, repairedLeaks: 0, totalLeaks: 3, pressure: 0, timeLeft: 45 }
            };
            
            // Reset UI elements
            document.getElementById('playerPath').setAttribute('d', '');
            document.getElementById('heatGauge').style.width = '0%';
            document.querySelectorAll('.weld-point').forEach(point => {
                point.style.background = '#f44336';
                point.classList.add('animate-pulse');
                point.onclick = function() { weldPoint(this); };
            });
            document.querySelectorAll('.leak-point').forEach(leak => {
                leak.style.background = '#f44336';
                leak.classList.add('animate-ping');
                leak.onclick = function() { repairLeak(this); };
            });
            document.querySelectorAll('.equipment-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-cyan-400');
            });
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Add some initial visual effects
            setInterval(() => {
                if (document.getElementById('mainMenu').classList.contains('hidden')) return;
                
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                createSparks(x, y, 1);
            }, 2000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9785c4c4a4d57b68',t:'MTc1Njc0MDIwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
