<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Kanit', sans-serif;
        }
        
        .brick {
            transition: all 0.3s ease;
            cursor: grab;
        }
        
        .brick:active {
            cursor: grabbing;
            transform: scale(1.1);
        }
        
        .drop-zone {
            transition: all 0.2s ease;
        }
        
        .drop-zone.drag-over {
            background-color: #fef3c7;
            border-color: #f59e0b;
            transform: scale(1.05);
        }
        
        .success-animation {
            animation: bounce 0.6s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .material-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .material-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .material-card.selected {
            border: 3px solid #10b981;
            background-color: #d1fae5;
        }
        
        .safety-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .safety-option:hover {
            transform: scale(1.05);
            background-color: #fef3c7;
        }
        
        .safety-option.correct {
            background-color: #d1fae5;
            border-color: #10b981;
        }
        
        .safety-option.incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
        }
        
        .custom-btn-blue:hover {
            background-color: #4a5a8f !important;
        }
        
        .custom-btn-red:hover {
            background-color: #d43f42 !important;
        }
        
        .custom-btn-yellow:hover {
            background-color: #d4a03a !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-100 to-blue-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">üéÆ ‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</h1>
            <p class="text-lg text-gray-600">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡πà‡∏≤‡∏ô 3 ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏•‡∏±‡∏Å</p>
            <div class="mt-4 bg-white rounded-lg p-4 inline-block shadow-lg">
                <div class="flex items-center space-x-6">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="totalScore">0</div>
                        <div class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="currentLevel">1</div>
                        <div class="text-sm text-gray-500">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600" id="timer">90</div>
                        <div class="text-sm text-gray-500">‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Start Game Screen -->
        <div id="startScreen" class="max-w-2xl mx-auto bg-white rounded-xl shadow-xl p-8 text-center">
            <div class="mb-6">
                <div class="text-8xl mb-4">üèóÔ∏è</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?</h2>
                <p class="text-lg text-gray-600 mb-6">‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô 3 ‡∏î‡πâ‡∏≤‡∏ô:</p>
                
                <div class="grid md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-red-50 rounded-lg p-4">
                        <div class="text-3xl mb-2">üß±</div>
                        <h3 class="font-semibold text-red-600">‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á</h3>
                        <p class="text-sm text-gray-600">‡∏ß‡∏≤‡∏á‡∏≠‡∏¥‡∏ê‡∏ï‡∏≤‡∏°‡πÅ‡∏õ‡∏•‡∏ô</p>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-4">
                        <div class="text-3xl mb-2">üîß</div>
                        <h3 class="font-semibold text-blue-600">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏</h3>
                        <p class="text-sm text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</p>
                    </div>
                    <div class="bg-orange-50 rounded-lg p-4">
                        <div class="text-3xl mb-2">‚ö†Ô∏è</div>
                        <h3 class="font-semibold text-orange-600">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h3>
                        <p class="text-sm text-gray-600">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</p>
                    </div>
                </div>
                
                <div class="bg-yellow-50 rounded-lg p-4 mb-6">
                    <p class="text-sm text-gray-700">
                        <strong>‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤:</strong> 90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à<br>
                        <strong>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:</strong> ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à<br>
                        <strong>üèÜ ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:</strong> ‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                    </p>
                </div>
            </div>
            
            <button id="startGame" class="custom-btn-blue text-white px-12 py-4 rounded-lg font-bold text-xl transition-all transform hover:scale-105 shadow-lg" style="background-color: #5568a0;">
                üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
            </button>
        </div>

        <!-- Game Container -->
        <div id="gameContainer" class="max-w-4xl mx-auto">
            
            <!-- Mission 1: Building Simulation -->
            <div id="mission1" class="game-mission bg-white rounded-xl shadow-xl p-8 mb-8 hidden">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-red-600 mb-2">üß± ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏≥‡∏•‡∏≠‡∏á</h2>
                    <p class="text-gray-600">‡∏•‡∏≤‡∏Å‡∏≠‡∏¥‡∏ê‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏õ‡∏•‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Blueprint -->
                    <div class="bg-blue-50 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4 text-center">üìã ‡πÅ‡∏õ‡∏•‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</h3>
                        <div class="grid grid-cols-5 gap-2" id="blueprint">
                            <!-- Blueprint will be generated by JS -->
                        </div>
                    </div>
                    
                    <!-- Building Area -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4 text-center">üèóÔ∏è ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</h3>
                        <div class="grid grid-cols-5 gap-2 mb-6" id="buildingArea">
                            <!-- Building area will be generated by JS -->
                        </div>
                        
                        <!-- Available Bricks -->
                        <div class="mt-6">
                            <h4 class="font-semibold mb-3">‡∏≠‡∏¥‡∏ê‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ:</h4>
                            <div class="flex flex-wrap gap-2" id="availableBricks">
                                <!-- Bricks will be generated by JS -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-6">
                    <button id="checkBuilding" class="custom-btn-red text-white px-8 py-3 rounded-lg font-semibold text-lg transition-colors" style="background-color: #e54c4e;">
                        ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏á‡∏≤‡∏ô
                    </button>
                </div>
            </div>

            <!-- Mission 2: Material Matching -->
            <div id="mission2" class="game-mission bg-white rounded-xl shadow-xl p-8 mb-8 hidden">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-blue-600 mb-2">üîß ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏</h2>
                    <p class="text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</p>
                </div>
                
                <div class="bg-yellow-50 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold mb-4 text-center">üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå</h3>
                    <div class="text-center">
                        <div class="text-2xl mb-2" id="materialQuestion">üè¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏π‡∏á 10 ‡∏ä‡∏±‡πâ‡∏ô</div>
                        <p class="text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4" id="materialOptions">
                    <!-- Material options will be generated by JS -->
                </div>
                
                <div class="text-center mt-6">
                    <button id="checkMaterial" class="custom-btn-yellow text-white px-8 py-3 rounded-lg font-semibold text-lg transition-colors" style="background-color: #ecb445;">
                        ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    </button>
                </div>
            </div>

            <!-- Mission 3: Safety Challenge -->
            <div id="mission3" class="game-mission bg-white rounded-xl shadow-xl p-8 mb-8 hidden">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-orange-600 mb-2">‚ö†Ô∏è ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 3: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h2>
                    <p class="text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
                </div>
                
                <div class="bg-red-50 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold mb-4 text-center">üö® ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå</h3>
                    <div class="text-center">
                        <div class="text-6xl mb-4" id="safetyScenarioIcon">üî®</div>
                        <div class="text-xl mb-2" id="safetyScenario">‡∏°‡∏µ‡∏Ñ‡πâ‡∏≠‡∏ô‡∏ï‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Ç‡∏ì‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô</div>
                        <p class="text-gray-600">‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4" id="safetyOptions">
                    <!-- Safety options will be generated by JS -->
                </div>
            </div>

            <!-- Results -->
            <div id="results" class="game-mission bg-white rounded-xl shadow-xl p-8 hidden">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-purple-600 mb-2">üèÜ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
                    <p class="text-gray-600">‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-red-50 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-2">üß±</div>
                        <h3 class="font-semibold mb-2">‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á</h3>
                        <div class="text-2xl font-bold text-red-600" id="buildingScore">0</div>
                        <div class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-2">üîß</div>
                        <h3 class="font-semibold mb-2">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏</h3>
                        <div class="text-2xl font-bold text-blue-600" id="materialScore">0</div>
                        <div class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                    </div>
                    <div class="bg-orange-50 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-2">‚ö†Ô∏è</div>
                        <h3 class="font-semibold mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h3>
                        <div class="text-2xl font-bold text-orange-600" id="safetyScore">0</div>
                        <div class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-6 text-center">
                    <h3 class="text-2xl font-bold mb-4">üåü ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
                    <div class="text-xl" id="skillResult">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</div>
                    <div class="mt-4">
                        <button id="playAgain" class="custom-btn-blue text-white px-8 py-3 rounded-lg font-bold text-lg transition-colors" style="background-color: #5568a0;">
                            üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class ConstructionGame {
            constructor() {
                this.currentMission = 1;
                this.scores = { building: 0, material: 0, safety: 0 };
                this.timeLeft = 90;
                this.timer = null;
                this.blueprint = [];
                this.buildingState = [];
                this.selectedMaterial = null;
                this.gameStarted = false;
                
                this.bindEvents();
            }
            
            init() {
                this.setupMission1();
                this.setupMission2();
                this.setupMission3();
                this.startTimer();
            }
            
            startTimer() {
                this.timer = setInterval(() => {
                    this.timeLeft--;
                    document.getElementById('timer').textContent = this.timeLeft;
                    
                    if (this.timeLeft <= 0) {
                        this.endGame();
                    }
                }, 1000);
            }
            
            setupMission1() {
                // Generate random blueprint pattern
                this.blueprintPatterns = [
                    // Pattern 1: Simple house
                    [
                        [1, 1, 1, 1, 1],
                        [1, 0, 1, 0, 1],
                        [1, 0, 0, 0, 1],
                        [1, 1, 0, 1, 1],
                        [1, 1, 1, 1, 1]
                    ],
                    // Pattern 2: Tower
                    [
                        [0, 1, 1, 1, 0],
                        [0, 1, 0, 1, 0],
                        [1, 1, 0, 1, 1],
                        [1, 0, 0, 0, 1],
                        [1, 1, 1, 1, 1]
                    ],
                    // Pattern 3: Complex structure
                    [
                        [1, 0, 1, 0, 1],
                        [1, 1, 1, 1, 1],
                        [0, 1, 0, 1, 0],
                        [1, 1, 1, 1, 1],
                        [1, 0, 1, 0, 1]
                    ],
                    // Pattern 4: Bridge
                    [
                        [1, 0, 0, 0, 1],
                        [1, 0, 0, 0, 1],
                        [1, 1, 1, 1, 1],
                        [1, 0, 0, 0, 1],
                        [1, 0, 0, 0, 1]
                    ],
                    // Pattern 5: Castle
                    [
                        [1, 0, 1, 0, 1],
                        [1, 1, 1, 1, 1],
                        [1, 0, 1, 0, 1],
                        [1, 0, 1, 0, 1],
                        [1, 1, 1, 1, 1]
                    ]
                ];
                
                // Select random pattern
                this.blueprint = this.blueprintPatterns[Math.floor(Math.random() * this.blueprintPatterns.length)];
                
                this.buildingState = [
                    [0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0]
                ];
                
                this.renderBlueprint();
                this.renderBuildingArea();
                this.renderAvailableBricks();
            }
            
            renderBlueprint() {
                const container = document.getElementById('blueprint');
                container.innerHTML = '';
                
                this.blueprint.forEach((row, i) => {
                    row.forEach((cell, j) => {
                        const div = document.createElement('div');
                        div.className = `w-12 h-12 border-2 ${cell ? 'bg-red-400 border-red-600' : 'bg-gray-200 border-gray-400'} rounded`;
                        if (cell) {
                            div.innerHTML = 'üß±';
                            div.className += ' flex items-center justify-center text-lg';
                        }
                        container.appendChild(div);
                    });
                });
            }
            
            renderBuildingArea() {
                const container = document.getElementById('buildingArea');
                container.innerHTML = '';
                
                this.buildingState.forEach((row, i) => {
                    row.forEach((cell, j) => {
                        const div = document.createElement('div');
                        div.className = `w-12 h-12 border-2 border-dashed border-gray-400 rounded drop-zone flex items-center justify-center text-lg`;
                        div.dataset.row = i;
                        div.dataset.col = j;
                        
                        if (cell) {
                            div.innerHTML = 'üß±';
                            div.className = div.className.replace('border-dashed border-gray-400', 'border-solid border-red-600 bg-red-400');
                        }
                        
                        this.addDropListeners(div);
                        container.appendChild(div);
                    });
                });
            }
            
            renderAvailableBricks() {
                const container = document.getElementById('availableBricks');
                container.innerHTML = '';
                
                // Count needed bricks
                const neededBricks = this.blueprint.flat().filter(cell => cell === 1).length;
                
                for (let i = 0; i < neededBricks + 2; i++) {
                    const brick = document.createElement('div');
                    brick.className = 'w-12 h-12 bg-red-400 border-2 border-red-600 rounded brick flex items-center justify-center text-lg';
                    brick.innerHTML = 'üß±';
                    brick.draggable = true;
                    brick.dataset.brickId = i;
                    
                    brick.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', e.target.dataset.brickId);
                    });
                    
                    container.appendChild(brick);
                }
            }
            
            addDropListeners(dropZone) {
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('drag-over');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('drag-over');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                    
                    const row = parseInt(dropZone.dataset.row);
                    const col = parseInt(dropZone.dataset.col);
                    
                    if (this.buildingState[row][col] === 0) {
                        this.buildingState[row][col] = 1;
                        dropZone.innerHTML = 'üß±';
                        dropZone.className = dropZone.className.replace('border-dashed border-gray-400', 'border-solid border-red-600 bg-red-400');
                        dropZone.classList.add('success-animation');
                        
                        // Remove the dragged brick
                        const brickId = e.dataTransfer.getData('text/plain');
                        const brick = document.querySelector(`[data-brick-id="${brickId}"]`);
                        if (brick) brick.remove();
                    }
                });
            }
            
            setupMission2() {
                this.allMaterialQuestions = [
                    {
                        question: "üè¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏π‡∏á 20 ‡∏ä‡∏±‡πâ‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏Å",
                        options: [
                            { name: "‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å", icon: "üèóÔ∏è", correct: true },
                            { name: "‡πÑ‡∏°‡πâ‡∏™‡∏ô", icon: "ü™µ", correct: false },
                            { name: "‡∏≠‡∏¥‡∏ê‡πÅ‡∏î‡∏á", icon: "üß±", correct: false },
                            { name: "‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°", icon: "üîß", correct: false }
                        ]
                    },
                    {
                        question: "üè† ‡∏õ‡∏π‡∏û‡∏∑‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô",
                        options: [
                            { name: "‡∏Å‡∏£‡∏∞‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡πÄ‡∏ã‡∏£‡∏≤‡∏°‡∏¥‡∏Å", icon: "‚¨ú", correct: true },
                            { name: "‡∏û‡∏£‡∏°‡∏Ç‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå", icon: "üß∂", correct: false },
                            { name: "‡πÑ‡∏°‡πâ‡πÑ‡∏ú‡πà", icon: "üéã", correct: false },
                            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏£‡∏≤‡∏¢", icon: "üìÑ", correct: false }
                        ]
                    },
                    {
                        question: "üåä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡πâ‡∏ô‡∏ô‡πâ‡∏≥‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà",
                        options: [
                            { name: "‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡∏°‡∏ß‡∏•‡πÄ‡∏ö‡∏≤", icon: "üèóÔ∏è", correct: true },
                            { name: "‡πÑ‡∏°‡πâ‡πÑ‡∏ú‡πà", icon: "üéã", correct: false },
                            { name: "‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", icon: "‚ôªÔ∏è", correct: false },
                            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÅ‡∏Ç‡πá‡∏á", icon: "üì¶", correct: false }
                        ]
                    },
                    {
                        question: "üî• ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡∏≤‡πÄ‡∏ú‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á 1000¬∞C",
                        options: [
                            { name: "‡∏≠‡∏¥‡∏ê‡∏ó‡∏ô‡πÑ‡∏ü", icon: "üß±", correct: true },
                            { name: "‡πÑ‡∏°‡πâ‡πÅ‡∏Ç‡πá‡∏á", icon: "ü™µ", correct: false },
                            { name: "‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", icon: "‚ôªÔ∏è", correct: false },
                            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©", icon: "üìÑ", correct: false }
                        ]
                    },
                    {
                        question: "‚ùÑÔ∏è ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
                        options: [
                            { name: "‡πÇ‡∏ü‡∏°‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", icon: "üßä", correct: true },
                            { name: "‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏ö‡∏≤‡∏á", icon: "üî©", correct: false },
                            { name: "‡πÑ‡∏°‡πâ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤", icon: "ü™µ", correct: false },
                            { name: "‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡πÉ‡∏™", icon: "ü™ü", correct: false }
                        ]
                    },
                    {
                        question: "üèä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∞‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á",
                        options: [
                            { name: "‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡∏Å‡∏±‡∏ô‡∏ã‡∏∂‡∏°", icon: "üèóÔ∏è", correct: true },
                            { name: "‡πÑ‡∏°‡πâ‡πÑ‡∏ú‡πà", icon: "üéã", correct: false },
                            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≥", icon: "üìÑ", correct: false },
                            { name: "‡∏ú‡πâ‡∏≤‡πÉ‡∏ö", icon: "üé™", correct: false }
                        ]
                    }
                ];
                
                // Randomly select 4 questions for this round
                this.materialQuestions = this.shuffleArray([...this.allMaterialQuestions]).slice(0, 4);
                this.currentQuestion = 0;
                this.renderMaterialQuestion();
            }
            
            renderMaterialQuestion() {
                const question = this.materialQuestions[this.currentQuestion];
                document.getElementById('materialQuestion').textContent = question.question;
                
                const container = document.getElementById('materialOptions');
                container.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const card = document.createElement('div');
                    card.className = 'material-card bg-white border-2 border-gray-300 rounded-lg p-6 text-center';
                    card.innerHTML = `
                        <div class="text-4xl mb-3">${option.icon}</div>
                        <div class="font-semibold">${option.name}</div>
                    `;
                    card.dataset.correct = option.correct;
                    card.dataset.index = index;
                    
                    card.addEventListener('click', () => {
                        document.querySelectorAll('.material-card').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        this.selectedMaterial = option.correct;
                    });
                    
                    container.appendChild(card);
                });
            }
            
            setupMission3() {
                this.allSafetyScenarios = [
                    {
                        icon: "üî®",
                        scenario: "‡∏°‡∏µ‡∏Ñ‡πâ‡∏≠‡∏ô‡∏ï‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á 5 ‡πÄ‡∏°‡∏ï‡∏£ ‡∏Ç‡∏ì‡∏∞‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å",
                        options: [
                            { text: "‡∏´‡∏•‡∏ö‡πÑ‡∏õ‡πÉ‡∏ï‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á", icon: "üèóÔ∏è", correct: true },
                            { text: "‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏µ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á", icon: "üèÉ", correct: false },
                            { text: "‡∏¢‡∏∑‡∏ô‡∏ô‡∏¥‡πà‡∏á‡∏°‡∏≠‡∏á‡∏î‡∏π", icon: "üëÄ", correct: false },
                            { text: "‡πÉ‡∏ä‡πâ‡∏°‡∏∑‡∏≠‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏´‡∏±‡∏ß", icon: "ü§≤", correct: false }
                        ]
                    },
                    {
                        icon: "‚ö°",
                        scenario: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏£‡∏á‡∏™‡∏π‡∏á‡∏Ç‡∏≤‡∏î‡∏ï‡∏Å‡∏•‡∏á‡∏°‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô",
                        options: [
                            { text: "‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤", icon: "üîå", correct: true },
                            { text: "‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πâ‡∏ú‡∏•‡∏±‡∏Å‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏≠‡∏≠‡∏Å", icon: "ü™µ", correct: false },
                            { text: "‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏ü", icon: "üíß", correct: false },
                            { text: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡πÄ‡∏£‡πá‡∏ß‡πÜ", icon: "üö∂", correct: false }
                        ]
                    },
                    {
                        icon: "üèóÔ∏è",
                        scenario: "‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏ô‡∏™‡∏π‡∏á 15 ‡πÄ‡∏°‡∏ï‡∏£ ‡∏•‡∏°‡πÅ‡∏£‡∏á 40 ‡∏Å‡∏°./‡∏ä‡∏°.",
                        options: [
                            { text: "‡∏´‡∏¢‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡∏£‡∏≠‡∏•‡∏°‡∏™‡∏á‡∏ö", icon: "‚è∏Ô∏è", correct: true },
                            { text: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ï‡∏±‡∏ß", icon: "‚ö†Ô∏è", correct: false },
                            { text: "‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏°", icon: "ü™¢", correct: false },
                            { text: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à", icon: "‚ö°", correct: false }
                        ]
                    },
                    {
                        icon: "üî•",
                        scenario: "‡πÄ‡∏Å‡∏¥‡∏î‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° ‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î",
                        options: [
                            { text: "‡πÉ‡∏ä‡πâ‡∏ñ‡∏±‡∏á‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏û‡∏¢‡∏û", icon: "üßØ", correct: true },
                            { text: "‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏ü", icon: "üíß", correct: false },
                            { text: "‡πÉ‡∏ä‡πâ‡∏ú‡πâ‡∏≤‡∏õ‡∏¥‡∏î‡πÑ‡∏ü", icon: "üßΩ", correct: false },
                            { text: "‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏±‡∏î‡∏•‡∏°‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", icon: "üí®", correct: false }
                        ]
                    },
                    {
                        icon: "‚ò†Ô∏è",
                        scenario: "‡∏û‡∏ö‡πÅ‡∏Å‡πä‡∏™‡∏£‡∏±‡πà‡∏ß‡πÉ‡∏ô‡∏ö‡πà‡∏≠‡∏•‡∏∂‡∏Å ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÑ‡∏õ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô",
                        options: [
                            { text: "‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÅ‡∏Å‡πä‡∏™‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", icon: "üìä", correct: true },
                            { text: "‡∏à‡∏∏‡∏î‡πÑ‡∏ü‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏Å‡πä‡∏™", icon: "üî•", correct: false },
                            { text: "‡∏•‡∏á‡πÑ‡∏õ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πä‡∏™‡πÄ‡∏û‡∏¥‡πà‡∏°", icon: "‚¨áÔ∏è", correct: false },
                            { text: "‡∏™‡∏ß‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡∏ú‡πâ‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤", icon: "üò∑", correct: false }
                        ]
                    },
                    {
                        icon: "üåßÔ∏è",
                        scenario: "‡∏ù‡∏ô‡∏ï‡∏Å‡∏´‡∏ô‡∏±‡∏Å ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£",
                        options: [
                            { text: "‡∏´‡∏¢‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡∏£‡∏≠‡∏ù‡∏ô‡∏´‡∏¢‡∏∏‡∏î", icon: "‚è∏Ô∏è", correct: true },
                            { text: "‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏°‡∏Å‡∏±‡∏ô‡∏ù‡∏ô", icon: "‚òÇÔ∏è", correct: false },
                            { text: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à", icon: "‚ö°", correct: false },
                            { text: "‡πÉ‡∏ä‡πâ‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°", icon: "üõçÔ∏è", correct: false }
                        ]
                    }
                ];
                
                // Randomly select 3 scenarios for this round
                this.safetyScenarios = this.shuffleArray([...this.allSafetyScenarios]).slice(0, 3);
                this.currentSafety = 0;
                this.renderSafetyScenario();
            }
            
            renderSafetyScenario() {
                const scenario = this.safetyScenarios[this.currentSafety];
                document.getElementById('safetyScenarioIcon').textContent = scenario.icon;
                document.getElementById('safetyScenario').textContent = scenario.scenario;
                
                const container = document.getElementById('safetyOptions');
                container.innerHTML = '';
                
                scenario.options.forEach((option, index) => {
                    const card = document.createElement('div');
                    card.className = 'safety-option bg-white border-2 border-gray-300 rounded-lg p-6 text-center';
                    card.innerHTML = `
                        <div class="text-4xl mb-3">${option.icon}</div>
                        <div class="font-semibold">${option.text}</div>
                    `;
                    card.dataset.correct = option.correct;
                    
                    card.addEventListener('click', () => {
                        this.checkSafetyAnswer(card, option.correct);
                    });
                    
                    container.appendChild(card);
                });
            }
            
            bindEvents() {
                document.getElementById('startGame').addEventListener('click', () => {
                    this.startGame();
                });
                
                document.getElementById('checkBuilding').addEventListener('click', () => {
                    this.checkBuilding();
                });
                
                document.getElementById('checkMaterial').addEventListener('click', () => {
                    this.checkMaterial();
                });
                
                document.getElementById('playAgain').addEventListener('click', () => {
                    this.resetGame();
                });
            }
            
            startGame() {
                this.gameStarted = true;
                document.getElementById('startScreen').classList.add('hidden');
                document.getElementById('mission1').classList.remove('hidden');
                this.init();
            }
            
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
            
            checkBuilding() {
                let correct = 0;
                let total = 0;
                
                for (let i = 0; i < 5; i++) {
                    for (let j = 0; j < 5; j++) {
                        if (this.blueprint[i][j] === 1) {
                            total++;
                            if (this.buildingState[i][j] === 1) {
                                correct++;
                            }
                        }
                    }
                }
                
                const score = Math.round((correct / total) * 100);
                this.scores.building = score;
                
                this.showMissionResult(`‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 1 ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!\n‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}/100\n‡∏ß‡∏≤‡∏á‡∏≠‡∏¥‡∏ê‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ${correct}/${total} ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á`, () => {
                    this.nextMission();
                });
            }
            
            checkMaterial() {
                if (this.selectedMaterial === null) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡πà‡∏≠‡∏ô');
                    return;
                }
                
                const score = this.selectedMaterial ? 100 : 0;
                this.scores.material += score;
                
                this.currentQuestion++;
                if (this.currentQuestion < this.materialQuestions.length) {
                    this.selectedMaterial = null;
                    this.renderMaterialQuestion();
                } else {
                    this.scores.material = Math.round(this.scores.material / this.materialQuestions.length);
                    this.showMissionResult(`‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 2 ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!\n‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${this.scores.material}/100`, () => {
                        this.nextMission();
                    });
                }
            }
            
            checkSafetyAnswer(card, isCorrect) {
                document.querySelectorAll('.safety-option').forEach(option => {
                    option.style.pointerEvents = 'none';
                    if (option.dataset.correct === 'true') {
                        option.classList.add('correct');
                    } else {
                        option.classList.add('incorrect');
                    }
                });
                
                const score = isCorrect ? 100 : 0;
                this.scores.safety += score;
                
                setTimeout(() => {
                    this.currentSafety++;
                    if (this.currentSafety < this.safetyScenarios.length) {
                        this.renderSafetyScenario();
                    } else {
                        this.scores.safety = Math.round(this.scores.safety / this.safetyScenarios.length);
                        this.showMissionResult(`‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 3 ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!\n‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${this.scores.safety}/100`, () => {
                            this.showResults();
                        });
                    }
                }, 2000);
            }
            
            nextMission() {
                document.getElementById(`mission${this.currentMission}`).classList.add('hidden');
                this.currentMission++;
                document.getElementById('currentLevel').textContent = this.currentMission;
                document.getElementById(`mission${this.currentMission}`).classList.remove('hidden');
                
                // Reset timer for new mission
                this.timeLeft = 90;
            }
            
            showMissionResult(message, callback) {
                alert(message);
                setTimeout(callback, 500);
            }
            
            showResults() {
                clearInterval(this.timer);
                document.getElementById(`mission${this.currentMission}`).classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');
                
                // Update scores
                document.getElementById('buildingScore').textContent = this.scores.building;
                document.getElementById('materialScore').textContent = this.scores.material;
                document.getElementById('safetyScore').textContent = this.scores.safety;
                
                const totalScore = this.scores.building + this.scores.material + this.scores.safety;
                document.getElementById('totalScore').textContent = totalScore;
                
                // Evaluate performance and suggest position
                const evaluation = this.evaluatePerformance();
                document.getElementById('skillResult').innerHTML = evaluation;
            }
            
            evaluatePerformance() {
                const totalScore = this.scores.building + this.scores.material + this.scores.safety;
                const avgScore = Math.round(totalScore / 3);
                
                // Find strongest skill
                const skills = [
                    { name: 'building', score: this.scores.building, label: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á' },
                    { name: 'material', score: this.scores.material, label: '‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏' },
                    { name: 'safety', score: this.scores.safety, label: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' }
                ];
                
                skills.sort((a, b) => b.score - a.score);
                const strongestSkill = skills[0];
                const secondSkill = skills[1];
                
                // Determine performance level and position
                let level, position, description, icon;
                
                if (avgScore >= 90) {
                    level = "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç";
                    if (strongestSkill.name === 'building') {
                        position = "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á";
                        icon = "üë∑‚Äç‚ôÇÔ∏è";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û";
                    } else if (strongestSkill.name === 'material') {
                        position = "‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™";
                        icon = "üî¨";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á";
                    } else {
                        position = "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢";
                        icon = "üõ°Ô∏è";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏î‡πâ";
                    }
                } else if (avgScore >= 75) {
                    level = "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç";
                    if (strongestSkill.name === 'building') {
                        position = "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á";
                        icon = "üë®‚Äçüîß";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ";
                    } else if (strongestSkill.name === 'material') {
                        position = "‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ß‡∏±‡∏™‡∏î‡∏∏";
                        icon = "üß™";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÑ‡∏î‡πâ";
                    } else {
                        position = "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢";
                        icon = "‚ö†Ô∏è";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û";
                    }
                } else if (avgScore >= 60) {
                    level = "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£";
                    if (strongestSkill.name === 'building') {
                        position = "‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™";
                        icon = "üî®";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à";
                    } else if (strongestSkill.name === 'material') {
                        position = "‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏";
                        icon = "üìã";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ä‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ";
                    } else {
                        position = "‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢";
                        icon = "ü¶∫";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏î‡πâ";
                    }
                } else if (avgScore >= 40) {
                    level = "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô";
                    if (strongestSkill.name === 'building') {
                        position = "‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î";
                        icon = "üéì";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°";
                    } else if (strongestSkill.name === 'material') {
                        position = "‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏";
                        icon = "üì¶";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°";
                    } else {
                        position = "‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ";
                        icon = "üë∑";
                        description = "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°";
                    }
                } else {
                    level = "‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤";
                    position = "‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°";
                    icon = "üìö";
                    description = "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á";
                }
                
                // Create detailed result
                let result = `
                    <div class="space-y-4">
                        <div class="text-center">
                            <div class="text-6xl mb-2">${icon}</div>
                            <div class="text-2xl font-bold text-purple-600">${level}</div>
                            <div class="text-xl font-semibold text-gray-800">${position}</div>
                        </div>
                        
                        <div class="bg-white rounded-lg p-4 border-2 border-purple-200">
                            <p class="text-gray-700 text-center">${description}</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-green-50 rounded-lg p-3">
                                <div class="font-semibold text-green-700">üéØ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á</div>
                                <div class="text-green-600">${strongestSkill.label} (${strongestSkill.score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</div>
                            </div>
                `;
                
                // Add improvement suggestion if needed
                const weakestSkill = skills[2];
                if (weakestSkill.score < 70) {
                    result += `
                            <div class="bg-orange-50 rounded-lg p-3">
                                <div class="font-semibold text-orange-700">üìà ‡∏Ñ‡∏ß‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤</div>
                                <div class="text-orange-600">${weakestSkill.label} (${weakestSkill.score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</div>
                            </div>
                    `;
                } else {
                    result += `
                            <div class="bg-blue-50 rounded-lg p-3">
                                <div class="font-semibold text-blue-700">‚≠ê ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡∏£‡∏≠‡∏á</div>
                                <div class="text-blue-600">${secondSkill.label} (${secondSkill.score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</div>
                            </div>
                    `;
                }
                
                result += `
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-3 text-center">
                            <div class="text-sm text-gray-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${totalScore}/300 | ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${avgScore}/100</div>
                        </div>
                    </div>
                `;
                
                return result;
            }
            
            resetGame() {
                clearInterval(this.timer);
                this.currentMission = 1;
                this.scores = { building: 0, material: 0, safety: 0 };
                this.timeLeft = 90;
                this.currentQuestion = 0;
                this.currentSafety = 0;
                this.selectedMaterial = null;
                this.gameStarted = false;
                
                // Hide all screens
                document.getElementById('results').classList.add('hidden');
                document.getElementById('mission1').classList.add('hidden');
                document.getElementById('mission2').classList.add('hidden');
                document.getElementById('mission3').classList.add('hidden');
                
                // Show start screen
                document.getElementById('startScreen').classList.remove('hidden');
                
                // Reset UI
                document.getElementById('currentLevel').textContent = 1;
                document.getElementById('totalScore').textContent = 0;
                document.getElementById('timer').textContent = 90;
            }
            
            endGame() {
                clearInterval(this.timer);
                alert('‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡∏•‡∏á');
                this.showResults();
            }
        }
        
        // Start the game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ConstructionGame();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9779fc83954c45bd',t:'MTc1NjYxNjY1OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
